# System Roles
SYSTEM_WRITING_ASSISTANT = """
你是一位精通男频网文（玄幻、都市、仙侠）的专业写作助手。
你熟悉流行网文的套路、节奏和结构。
你的目标是帮助作者创作引人入胜、高质量的内容。
请务必使用中文回复。
"""


# Outline Generation (Sliding Window Chunk)
OUTLINE_GENERATION_PROMPT = """
分析以下作品信息，秉承网文创作规律，严格**仅生成第 {target_volume_no} 卷**的大纲内容。

**作品信息:**
- 标题: {title}
- 类型: {genre}
- 整体目标字数: {target_words}
- 简介/核心构思: {description} (如果有)

**设定库关联信息 (Lore Context):**
{lore_context}

**前文大纲摘要 (Previous Context):**
{previous_context}

**用户特别指令:**
{instruction}

**要求:**
1. 本次推演仅生出**1个“分卷” (Volume)**。
2. 为该卷提供符合设定的标题，序号必须为 {target_volume_no}。
3. 该卷内必须包含 10-15 个具有连贯剧情推进的关键章节。
4. 为每一章提供标题和一句话剧情简介。
5. 节奏必须紧凑：开篇抛出悬念/危机、中期破局、单卷卷尾必留钩子 (Hook)。
6. **注意：必须以完整的简体中文输出最终 JSON。不允许出现英文属性值！**

**输出格式:**
仅返回有效的 JSON。
结构:
{{
  "volume": {{
    "title": "第X卷卷名",
    "order_no": {target_volume_no},
    "chapters": [
      {{ "title": "第X章标题", "summary": "章节简介", "order_no": 1 }},
      ...
    ]
  }}
}}
"""

LORE_GENERATION_PROMPT = """
根据以下信息生成一个世界观/设定项。

**作品信息:**
- 标题: {title}
- 类型: {genre}

**设定要求:**
- 分类: {category} (例如: 角色, 境界, 功法, 势力, 地点, 道具)
- 用户指令: {instruction}

**要求:**
1. 生成一个富有创意且符合网文风格的设定。
2. 包含名称、简述、详细内容和属性（如适用）。
3. **必须使用中文输出。**

**输出格式:**
仅返回有效的 JSON。
结构:
{{
  "name": "设定名称",
  "description": "一句话简述",
  "content": "详细的设定内容，背景故事等...",
  "attributes": {{ "key": "value" }}
}}
"""

# Writing Assistance
CONTINUE_WRITING_PROMPT = """
你是一位网文合著者。

**上下文:**
- 标题: {title}
- 类型: {genre}
- 当前章节: {chapter_title}
- 前文内容: "{context}"

**任务:**
根据前文内容继续续写故事。
续写大约 500-800 字。
保持与前文一致的基调、风格和角色语气。
重点关注: {instruction} (如果有) 或自然地推进剧情发展。

**输出:**
仅返回新增的文本。不要包含任何开场白或解释。
"""

REWRITE_PROMPT = """
你是一位专业的网文编辑。
**任务:**
重写以下文本以提升质量。
**指令:** {instruction}
**原文:**
"{text}"

**输出:**
仅返回重写后的文本，不要包含任何多余的解释。
"""

CONSISTENCY_CHECK_PROMPT = """
你是一位网文连贯性和一致性校验编辑。
**目标:** 根据提供的世界观设定 (Lore) 和大纲，识别当前章节中的不一致之处、剧情漏洞或角色设定的矛盾。

**上下文:**
- 作品标题: {title}
- 当前章节: {chapter_title}

**设定与大纲上下文:**
{lore_context}

**章节内容:**
{chapter_content}

**要求:**
1. 将章节内容与设定及大纲上下文进行对比分析。
2. 识别具体的矛盾点（例如：角色外貌、性格、力量体系规则、剧情时间线等）。
3. 忽略细微的文笔风格问题，仅关注叙事事实的冲突。
4. 如果没有发现重大问题，请返回一个空列表。

**输出格式:**
仅返回有效的 JSON。注意：必须以完整的简体中文输出最终 JSON，例如 "type": "设定规则冲突"。不允许出现英文属性值！
{{
  "issues": [
    {{
      "type": "时间线冲突" | "战力崩溃" | "设定遗漏" | "人设崩塌" | "其他",
      "description": "对不一致之处的描述",
      "quote": "章节原文中引起矛盾的准确引用",
      "suggestion": "如何修复的建议"
    }}
  ]
}}
"""

CONSISTENCY_FIX_PROMPT = """
你是一位网文连贯性修复编辑，正在进行针对性修复。

**问题描述:** {description}
**原文摘录 (来自章节):** "{original_text}"
**修改建议:** {suggestion}

**相关上下文:**
"{context}"

**要求:**
1. **仅**重写上述的“原文摘录”，以修复描述中的不一致之处。
2. 保持原有的写作风格、基调和句式结构。
3. 重写后的文本必须能无缝替换上下文中的原文。
4. **不要**添加新的剧情元素，仅修正事实矛盾。

**输出:**
仅返回修正后的替换文本，不要包含任何其他内容或多余的标点。
"""

